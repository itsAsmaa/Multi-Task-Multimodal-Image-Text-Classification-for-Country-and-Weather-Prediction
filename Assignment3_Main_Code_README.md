# Travel Image & Text Classification - Assignment 3

## ğŸ“‹ Project Overview

This project performs multi-modal machine learning tasks for travel data classification:
- **Image Classification**: Predicting countries and weather conditions from images
- **Text Classification**: Predicting countries from text descriptions
- **Multi-Modal Fusion**: Combining text and images for improved weather prediction

---

## ğŸ“ Required Files & Setup

### 1. Google Drive Structure
âš ï¸important Note : copy the required files to the folder you will create or use it directly by moving it to your "My Drive"
https://drive.google.com/drive/folders/1KjwzSlqG_EnS0HLGd4zvatCPQq5y_WkU?usp=drive_link

Create the following folder structure in your Google Drive:

```
My Drive/
â””â”€â”€ Assignment3_ENCS5341/
    â”œâ”€â”€ images/                          # Folder containing image files (img_0.jpg, img_1.jpg, etc.)
    â”œâ”€â”€ X_images_preprocessed.npy        # Preprocessed image array
    â””â”€â”€ df_filtered.csv                  # Filtered dataset with valid image paths
```

### 2. Required CSV File

Upload `all_students_combined_and_cleaned.csv` to your Colab environment. This file contains:
- Image URLs
- Text descriptions
- Country labels
- Weather labels
- Time of day, season, activity, mood/emotion data

---

## ğŸš€ How to Run the Code

### Step 1: Open in Google Colab

1. Go to [Google Colab](https://colab.research.google.com/)
2. Click **File â†’ Upload notebook**
3. Upload `Assignment3_Main_Code.ipynb`

### Step 2: Upload the CSV File

**Option A: Manual Upload (Recommended for first run)**
```python
# Run this cell in Colab
from google.colab import files
uploaded = files.upload()
# Select and upload: all_students_combined_and_cleaned.csv
```

**Option B: Upload to Colab Files**
1. Click the ğŸ“ folder icon in the left sidebar
2. Click the upload icon
3. Select `all_students_combined_and_cleaned.csv`
4. The file will be available at `/content/all_students_combined_and_cleaned.csv`

### Step 3: Mount Google Drive

The code will automatically prompt you to mount Google Drive:

```python
from google.colab import drive
drive.mount('/content/drive')
```

**Follow these steps:**
1. Click the link that appears
2. Select your Google account
3. Copy the authorization code
4. Paste it back in Colab

### Step 4: First-Time Setup (Images)

**Important:** The first time you run the code, it will:
1. Copy images from Drive to local Colab storage (faster processing)
2. Preprocess all images
3. Save preprocessed data back to Drive (`X_images_preprocessed.npy`)

This takes **~10-15 minutes** but only happens once!

```python
# The code automatically checks for preprocessed data
if os.path.exists(PREPROCESSED_PATH):
    print("âœ… Loading preprocessed images (FAST)...")
    X_images = np.load(PREPROCESSED_PATH)
else:
    print("â³ First-time setup - optimizing for speed...")
    # Preprocessing happens here
```

### Step 5: Run the Notebook

Execute cells sequentially using **Runtime â†’ Run all** or **Ctrl+F9**

---

## ğŸ“‚ File Locations Reference

### In Colab Environment:
```
/content/
â”œâ”€â”€ all_students_combined_and_cleaned.csv    # Upload this manually
â”œâ”€â”€ images/                                   # Copied from Drive automatically
â”œâ”€â”€ cleaned_data.csv                         # Generated by code
â”œâ”€â”€ train_data.csv                           # Generated by code
â””â”€â”€ test_data.csv                            # Generated by code
```

### In Google Drive:
```
/content/drive/MyDrive/Assignment3_ENCS5341/
â”œâ”€â”€ images/                                   # Create this folder
â”‚   â”œâ”€â”€ img_0.jpg
â”‚   â”œâ”€â”€ img_1.jpg
â”‚   â””â”€â”€ ...
â”œâ”€â”€ X_images_preprocessed.npy                # Auto-generated (first run)
â””â”€â”€ df_filtered.csv                          # Auto-generated (first run)
```

---

## âš ï¸ Important Notes

### 1. **CSV File Must Be Uploaded First**
Before running any cells, make sure `all_students_combined_and_cleaned.csv` is in `/content/`:
```python
import os
assert os.path.exists('all_students_combined_and_cleaned.csv'), "âŒ CSV file not found!"
print("âœ… CSV file is ready")
```

### 2. **Images Folder Setup**
If you don't have the images folder in Drive, the code will show:
```
âš ï¸ Could not load images: [error]
   Creating synthetic image features for demonstration...
```

To use real images:
1. Create folder: `My Drive/Assignment3_ENCS5341/images/`
2. Upload images named as: `img_0.jpg`, `img_1.jpg`, etc.
3. Re-run the notebook

### 3. **Drive Path Verification**
The code uses these paths - verify they match your Drive structure:
```python
DRIVE_IMAGE_DIR = "/content/drive/MyDrive/Assignment3_ENCS5341/images"
PREPROCESSED_PATH = "/content/drive/MyDrive/Assignment3_ENCS5341/X_images_preprocessed.npy"
LABELS_PATH = "/content/drive/MyDrive/Assignment3_ENCS5341/df_filtered.csv"
```

If your folder is named differently, update these paths in the code.

---

## ğŸ”§ Troubleshooting

### Problem: "CSV file not found"
**Solution:**
```python
# Check current directory
import os
print(os.listdir('/content'))

# If CSV is missing, upload it:
from google.colab import files
files.upload()
```

### Problem: "Drive not mounted"
**Solution:**
```python
from google.colab import drive
drive.mount('/content/drive', force_remount=True)
```

### Problem: "Images not found"
**Solution:**
```python
# Verify Drive path
import os
drive_path = "/content/drive/MyDrive/Assignment3_ENCS5341/images"
print(f"Exists: {os.path.exists(drive_path)}")
print(f"Contents: {os.listdir(drive_path) if os.path.exists(drive_path) else 'Not found'}")
```

### Problem: "Out of memory"
**Solution:**
- Go to **Runtime â†’ Change runtime type**
- Select **GPU** or **High-RAM**
- Click **Save**



## ğŸ¯ Project Structure

The code is organized into phases:

1. **ğŸ“· IMAGE PREDICTION**
   - Dataset loading and exploration
   - Image preprocessing
   - k-NN baseline models
   - CNN models (EfficientNet)
   - Multi-task learning

2. **ğŸ“ƒ TEXT PREDICTION**
   - Text preprocessing
   - TF-IDF feature extraction
   - k-NN models
   - Random Forest classifier
   - Naive Bayes classifier

3. **ğŸŒ¦ï¸ MULTI-MODAL FUSION**
   - Feature alignment
   - Early fusion (concatenation)
   - Late fusion (ensemble)
   - Performance comparison

---

## ğŸ’¾ Memory Management

The code includes optimizations:
- **Parallel image loading** (8 workers)
- **Preprocessed data caching** (saves to Drive)
- **Sparse matrix handling** (TF-IDF)
- **Batch processing** for large datasets

---

## ğŸ“ˆ Performance Metrics

All models are evaluated using:
- Accuracy
- Precision
- Recall
- F1-Score
- Confusion matrices
- Classification reports

---

## ğŸ¤ Support

If you encounter issues:
1. Check file paths match your Drive structure
2. Verify CSV file is uploaded to `/content/`
3. Ensure Drive is mounted
4. Try **Runtime â†’ Restart runtime** for memory issues

---

## âœ… Quick Checklist

Before running the code:

- [ ] CSV file uploaded to Colab (`/content/all_students_combined_and_cleaned.csv`)
- [ ] Google Drive mounted
- [ ] Images folder exists in Drive (optional but recommended)
- [ ] GPU runtime enabled (for faster training)
- [ ] All cells executed sequentially

---

âš ï¸**if you faced any issue running the code please contact one of us through ritaj our std.no : 1210084 1210618**
